# 数据库切换逻辑说明

本项目根据 `DEBUG` 配置项的值，自动切换数据库连接方式：

## 1. DEBUG=True 时

- 直接使用 `.env` 文件中配置的 `DATABASE_URL`。
- 适用于本地开发和测试环境。
- 例如：
  ```env
  DATABASE_URL=sqlite:///./database.db
  DEBUG=True
  ```
- 这样会连接本地 SQLite 数据库。

## 2. DEBUG=False 时

- 忽略 `.env` 文件中的 `DATABASE_URL`，而是根据以下环境变量动态拼接 PostgreSQL 连接字符串：
  - `DB_USER`
  - `DB_PASSWORD`
  - `DB_HOST`
  - `DB_PORT`
  - `DB_NAME`
- 适用于生产环境。
- 例如：
  ```env
  DEBUG=False
  DB_USER=your_user
  DB_PASSWORD=your_password
  DB_HOST=your_host
  DB_PORT=5432
  DB_NAME=your_db
  ```
- 这样会连接远程 PostgreSQL 数据库。

## 代码片段

`core/config.py` 相关逻辑：

```python
class Settings(BaseSettings):
    ...
    DATABASE_URL: str = None
    DEBUG: bool = False
    ...
    def __init__(self, **values):
        super().__init__(**values)
        if not self.DEBUG:
            db_user = os.getenv("DB_USER")
            db_password = os.getenv("DB_PASSWORD")
            db_host = os.getenv("DB_HOST")
            db_port = os.getenv("DB_PORT")
            db_name = os.getenv("DB_NAME")
            self.DATABASE_URL = f"postgresql://{db_user}:{db_password}@{db_host}:{db_port}/{db_name}"
```

---

如需切换数据库，只需修改 `.env` 文件中的 `DEBUG` 和相关变量即可。
